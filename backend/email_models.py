from sqlalchemy import Column, Integer, String, DateTime, Text, Boolean, ForeignKey\nfrom sqlalchemy.sql import func\nfrom database import Base\n\nclass EmailLog(Base):\n    \"\"\"Email log table for tracking sent emails\"\"\"\n    __tablename__ = \"email_logs\"\n    \n    id = Column(Integer, primary_key=True, index=True)\n    appointment_id = Column(Integer, ForeignKey('appointments.id'), nullable=False)\n    email_type = Column(String, nullable=False)  # 'reminder' or 'followup'\n    subject = Column(String, nullable=False)\n    to_email = Column(String, nullable=False)\n    to_name = Column(String)\n    status = Column(String, nullable=False)  # 'sent', 'failed', 'delivered', 'opened'\n    error_message = Column(Text)\n    message_id = Column(String)  # External service message ID\n    sent_at = Column(DateTime(timezone=True), server_default=func.now())\n    delivered_at = Column(DateTime(timezone=True))\n    opened_at = Column(DateTime(timezone=True))\n    clicked_at = Column(DateTime(timezone=True))\n    \nclass EmailTemplate(Base):\n    \"\"\"Email template table for storing reusable templates\"\"\"\n    __tablename__ = \"email_templates\"\n    \n    id = Column(Integer, primary_key=True, index=True)\n    name = Column(String, unique=True, index=True)\n    template_type = Column(String, nullable=False)  # 'reminder' or 'followup'\n    subject_template = Column(String, nullable=False)\n    html_template = Column(Text, nullable=False)\n    plain_text_template = Column(Text, nullable=False)\n    is_active = Column(Boolean, default=True)\n    created_at = Column(DateTime(timezone=True), server_default=func.now())\n    updated_at = Column(DateTime(timezone=True), onupdate=func.now())\n    \nclass EmailPreference(Base):\n    \"\"\"Email preferences for patients\"\"\"\n    __tablename__ = \"email_preferences\"\n    \n    id = Column(Integer, primary_key=True, index=True)\n    email = Column(String, unique=True, index=True)\n    reminder_emails = Column(Boolean, default=True)\n    followup_emails = Column(Boolean, default=True)\n    marketing_emails = Column(Boolean, default=True)\n    unsubscribe_token = Column(String, unique=True)\n    unsubscribed_at = Column(DateTime(timezone=True))\n    created_at = Column(DateTime(timezone=True), server_default=func.now())\n    updated_at = Column(DateTime(timezone=True), onupdate=func.now())